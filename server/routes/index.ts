import { Request, Response } from "express"
import { challenges } from "../challenges"

type RouteType = { path: string, callback: (req: Request, res: Response) => void }

export { routes }

const flagRoutes: Array<RouteType> = Object.keys(challenges)
    .map((challengeName) => ({
        path: `/${challengeName}`,
        callback: (req, res) => {
            if (req.query["flag"] === challenges[challengeName].flag) {
                res.send("YOUPI")
            } else {
                res.status(400);
                res.send("WRONG")
            }
        }
    }))

const routes: Array<RouteType> = [
    {
        path: "/challenge1-endpoint", callback: (_, res) => {
            res.send(challenges["challenge1"].flag)
        }
    },
    ...flagRoutes
]

