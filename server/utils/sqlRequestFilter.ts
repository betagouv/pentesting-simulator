export { sqlRequestFilter }

const sqlRequestFilter = {
    filterForbiddenWords
}

function filterForbiddenWords(sqlRequest: string) {
    const FORBIDDEN_COMMANDS = ["UPDATE", "DELETE", "INSERT", "CREATE", "ALTER", "DROP"]
    const FORBIDDEN_TABLES = ["flags"]
    const FORBIDDEN_WORDS = [...FORBIDDEN_COMMANDS, ...FORBIDDEN_TABLES]
    if (FORBIDDEN_WORDS.some(forbiddenWord => sqlRequest.match(forbiddenWord))) {
        throw new Error(`This request contains one or several forbidden words`)
    }
    return sqlRequest
}