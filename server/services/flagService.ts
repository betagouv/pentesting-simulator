import { client } from "../database"

export { flagService }

const flagService = { getFlag }

async function getFlag(challengeName: string) {
    try {
        const challenges = (await client.query(`SELECT flag FROM flags WHERE "challengeName"=$1`, [challengeName])).rows;
        if (challenges.length !== 1) {
            throw new Error(`No or several flags found for challengeName "${challengeName}"`)
        }
        return challenges[0].flag
    } catch (error) {
        console.error(error)
        throw new Error(`Error while trying to query flags for "${challengeName}"`)
    }
}