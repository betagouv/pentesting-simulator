import { client } from "../database";
import { sqlRequestFilter } from "../utils";

export { characterService }

const characterService = { getCharacterById, getCharacters }

async function getCharacterById(id: string) {
    const sqlRequest = sqlRequestFilter.filterForbiddenWords(`SELECT id, name FROM characters WHERE id=${id}`)

    const characters = (await client.query(sqlRequest)).rows
    if (characters.length > 0) {
        return characters[0]
    } else {
        throw new Error(`Cannot find character for id ${id}`);
    }
}

async function getCharacters() {
    const characters = await client.query(`SELECT id, name FROM characters`)
    return characters.rows
}