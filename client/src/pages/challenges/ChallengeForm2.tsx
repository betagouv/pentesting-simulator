import React, { ChangeEvent, FormEvent, useState } from "react"
import { Button, TextInput } from '@dataesr/react-dsfr'
import { submitPhrase } from "../../api";
import { Challenge } from "../../components";

export { ChallengeForm2 }

function ChallengeForm2() {
    const [phrase, setPhrase] = useState(0);
    return <Challenge challengeName="challengeForm2">
        <p>Essayez de soumettre au serveur le texte suivant : <strong>Un chasseur sachant chasser sans son chien est un sacr√© chasseur</strong></p>
        <form onSubmit={onSubmit}>
            <TextInput type="number" name="phrase" value={phrase} onChange={onChangePhrase} />
            <Button submit>Soumettre</Button>
        </form>
    </Challenge>

    function onChangePhrase(e: ChangeEvent<HTMLInputElement>) {
        const newValue = Number(e.target.value);

        if (!isNaN(newValue)) {
            setPhrase(newValue)
        }
    }

    async function onSubmit(event: FormEvent<HTMLFormElement>) {
        event.preventDefault();
        const { data } = await submitPhrase(phrase)
        if (!data) {
            alert(`Erreur ! Essaie encore :)`)
        }
    }

}
